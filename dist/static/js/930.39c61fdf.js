"use strict";(self["webpackChunkproject_01"]=self["webpackChunkproject_01"]||[]).push([[930],{4930:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"task-management"},[t("div",{staticClass:"right-header"},[t("el-button",{staticClass:"left-btn",attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.add("add")}}},[e._v("新增用户")]),t("div",{staticClass:"right-search"},[t("div",{staticClass:"search"},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入用户名"},model:{value:e.searchUserName,callback:function(t){e.searchUserName=t},expression:"searchUserName"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.btnSearch},slot:"append"})],1)],1)])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{id:"table",data:e.tableData,height:"calc(100% - 150px)"}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",index:e.indexMethod}}),t("el-table-column",{attrs:{prop:"user_name",label:"管理名"}}),t("el-table-column",{attrs:{prop:"user_count",label:"角色"}}),t("el-table-column",{attrs:{prop:"user_auth",label:"禁用"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:s.row.user_disabled,callback:function(t){e.$set(s.row,"user_disabled",t)},expression:"scope.row.user_disabled"}},[e._v("on")])]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.reset(s.row)}}},[e._v("重置密码")]),t("span",{staticStyle:{padding:"10px"}},[e._v("|")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.add("edit",s.row)}}},[e._v("修改")]),t("span",{staticStyle:{padding:"10px"}},[e._v("|")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteData(s.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{staticClass:"footer-pagination",attrs:{background:e.isBackground,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[5,10,20],layout:"total, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"30%","min-width":"400px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?t("FormEdit",{attrs:{formType:e.formType,formList:e.formList},on:{handleClose:e.handleClose}}):e._e()],1)],1)},a=[],n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"form-container"},[t("el-form",{ref:"form",staticClass:"demo-form",attrs:{model:e.form,rules:e.rules,"label-width":"70px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"user_name"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.form.user_name,callback:function(t){e.$set(e.form,"user_name",t)},expression:"form.user_name"}})],1),t("el-form-item",{attrs:{label:"账户",prop:"user_count"}},[t("el-input",{attrs:{placeholder:"请输入账户名"},model:{value:e.form.user_count,callback:function(t){e.$set(e.form,"user_count",t)},expression:"form.user_count"}})],1),t("el-form-item",{attrs:{label:"权限",prop:"user_auth"}},[t("el-select",{attrs:{placeholder:"请选择用户权限"},model:{value:e.form.user_auth,callback:function(t){e.$set(e.form,"user_auth",t)},expression:"form.user_auth"}},e._l(e.options,(function(e){return t("el-option",{key:e.user_auth,attrs:{label:e.user_auth_name,value:e.user_auth}})})),1)],1),t("el-form-item",{attrs:{align:"center"}},["add"==e.formType?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.btnSubmit("add")}}},[e._v("立即创建")]):e._e(),"edit"==e.formType?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.btnSubmit("edit")}}},[e._v("保存")]):e._e()],1)],1)],1)},o=[],i=s(4946),u={props:{formType:{type:String,default:""},formList:{type:Object,default:()=>({})}},data(){return{form:{user_type:"",user_count:"",user_name:"",user_passd:"123456",user_type:2},options:[],rules:{user_name:[{required:!0,message:"请输入用户名",trigger:"blur"}],user_count:[{required:!0,message:"请输入账户",trigger:"blur"}],user_auth:[{required:!0,message:"请选择权限",trigger:"blur"}]}}},created(){this.getUserAuth(),"add"!=this.formType&&this.getInfo()},methods:{getInfo(){(0,i.k8)({user_name:this.formList.user_name,user_count:this.formList.user_count}).then((e=>{const{code:t,data:s,message:r}=e;1==t?this.form=s[0]:this.$message.error(r)}))},btnSubmit(e){this.$refs.form.validate((t=>{if(!t)return!1;"add"==e?(0,i.Og)({user_name:this.form.user_name,user_count:this.form.user_count}).then((t=>{const{code:s,data:r,message:a}=t;1==s&&0==r[0].num?this.submitForm(e):this.$message.error("用户名或账户已存在！")})):this.submitForm(e)}))},submitForm(e){let t="add"==e?i.nu:i.TK;const s=this.$loading({lock:!0,text:"提交中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t(this.form).then((e=>{s.close();const{code:t,message:r}=e;1==t?(this.$message.success("您的操作已成功！"),this.$emit("handleClose")):this.$message.error(r)}))},getUserAuth(){(0,i.s5)({}).then((e=>{const{code:t,data:s,message:r}=e;console.log(s,"data"),1==t?this.options=s:this.$message.error(r)}))}}},l=u,c=s(1656),d=(0,c.A)(l,n,o,!1,null,"8122d180",null),m=d.exports,h={components:{FormEdit:m},data(){return{currentPage:1,pageSize:20,searchUserName:"",dialogVisible:!1,dialogTitle:"",isBackground:!0,formType:"",total:0,tableData:[{user_disabled:!1},{user_disabled:!0},{user_disabled:!1}],formList:{}}},created(){},methods:{indexMethod(e){return e+1},handleSizeChange(e){this.pageSize=e,this.getInfo()},handleCurrentChange(e){this.currentPage=e,this.getInfo()},add(e,t){this.formType=e,this.dialogVisible=!0,this.dialogTitle="add"==e?"新增":"编辑",this.formList=t},getInfo(){const e=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)",target:document.querySelector("#table")});(0,i.EZ)({page:this.currentPage,size:this.pageSize}).then((t=>{const{code:s,data:r,message:a}=t;e.close(),1==s?(this.tableData=r.list,this.total=r.total):this.$message.error(a)})).catch((t=>{e.close()}))},handleClose(){this.dialogVisible=!1,this.getInfo()},reset(e){this.$confirm("此操作将重置用户密码, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.user_passd="123456",(0,i.TK)(e).then((e=>{const{code:t,data:s,message:r}=e;1==t?(this.$message.success("您的操作已成功"),this.getInfo()):this.$message.error("您的操作已成功")}))})).catch((()=>{this.$message({type:"info",message:"已取消重置密码操作"})}))},deleteData(e){this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const t=this.$loading({lock:!0,text:"删除中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});(0,i.hG)({user_name:e.user_name,user_count:e.user_count}).then((e=>{t.close();const{code:s,data:r,message:a}=e;1==s?(this.$message.success("您的操作已成功"),this.getInfo()):this.$message.error(a)})).catch((e=>{t.close()}))})).catch((()=>{this.$message({type:"info",message:"已取消删除操作"})}))},btnSearch(){(0,i.EZ)({page:1,size:20,user_name:this.searchUserName}).then((e=>{const{code:t,data:s,message:r}=e;1==t?this.tableData=s.list:this.$message.error(r)}))}}},p=h,f=(0,c.A)(p,r,a,!1,null,"a4012514",null),g=f.exports},4946:function(e,t,s){s.d(t,{EZ:function(){return a},Og:function(){return c},TK:function(){return o},hG:function(){return l},k8:function(){return n},nu:function(){return u},s5:function(){return i}});var r=s(5720);function a(e){return(0,r.A)({url:"user/query_users",method:"POST",data:e})}function n(e){return(0,r.A)({url:"user/query_one_user",method:"POST",data:e})}function o(e){return(0,r.A)({url:"user/update_user",method:"POST",data:e})}function i(e){return(0,r.A)({url:"user/user_auth",method:"post",data:e})}function u(e){return(0,r.A)({url:"user/add_user",method:"POST",data:e})}function l(e){return(0,r.A)({url:"user/delete_user",method:"post",data:e})}function c(e){return(0,r.A)({url:"user/check_user",method:"post",data:e})}}}]);